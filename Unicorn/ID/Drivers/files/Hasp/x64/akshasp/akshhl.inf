;;;
;;; INF File for Sentinel HASP HL Function Driver
;;;
;;; Copyright (c) SafeNet Inc.
;;;

[Version]
signature="$Windows NT$"
Provider=%Fast%
Class=USB
ClassGuid={36fc9e60-c465-11cf-8056-444553540000}
DriverVer=02/06/2018,7.65
CatalogFile=akshhl.cat

[Manufacturer]
%FastMfg%=Gemalto,NTamd64

[Gemalto.NTamd64]
%AKSCLASS\HaspHL.DeviceDesc%=akshhl, Aladdin\Vid0529&Pid0001&HaspHL ;HASP HL Protection Device

;;
;; Coinstaller section
;;

[akshhl.nt.CoInstallers]
AddReg=akshhl.CoInstallers.reg
CopyFiles=GemaltoCoInstCopyFiles

[akshhl.CoInstallers.reg]
HKR,,CoInstallers32,0x00010000,"akshhl32.dll,AksHhlCoInstallEntryPoint"

[GemaltoCoInstCopyFiles]
akshhl32.dll

;;
;; AKS HASP HL Device NT Install Section
;;

[akshhl.NT]
CopyFiles=akshhl.NT.Copy
CopyFiles=aksllm.NT.Copy

[aksllm.NT.Copy]
aksllmtp.exe,hasplms.exe
hasplmv.exe

[akshhl.NT.Copy]
akshhl.sys
aksfridge.sys

[akshhl.NT.HW]
AddReg=akshhl.NT.HW.AddReg

[akshhl.NT.HW.AddReg]
HKR,,"BeepCount",0x00010003,4
HKLM,"SOFTWARE\Aladdin Knowledge Systems\HASP\Driver\Installer","DrvPkgVersion",0x0,"7.65"
HKLM,"SOFTWARE\Aladdin Knowledge Systems\HASP\Driver\Installer","Version",0x0,"7.65"
HKLM,"SOFTWARE\Wow6432Node\Aladdin Knowledge Systems\HASP\Driver\Installer","DrvPkgVersion",0x0,"7.65"
HKLM,"SOFTWARE\Wow6432Node\Aladdin Knowledge Systems\HASP\Driver\Installer","Version",0x0,"7.65"
HKLM,"SOFTWARE\Gemalto Sentinel\Sentinel LDK\raid\blacklist","iaStorA.sys",0x2,"11.5.0.1207"
HKLM,"SOFTWARE\Gemalto Sentinel\Sentinel LDK\raid\blacklist","iaStorB.sys",0x2,"4.0.0.1040"
HKLM,"SOFTWARE\Gemalto Sentinel\Sentinel LDK\raid\inclusion","iaStorA.sys",0x2,"13.1.0.1058"
HKLM,"SOFTWARE\Gemalto Sentinel\Sentinel LDK\raid\inclusion","iaStorB.sys",0x2,"13.1.0.1058"
HKLM,"SOFTWARE\Gemalto Sentinel\Sentinel LDK\raid\inclusion","iaStorV.sys",0x2,"8.6.2.1014"


[akshhl.NT.Services]
AddService=akshhl,0x02,akshhl.addservices
AddService=aksfridge,,aksfridge.Service
AddService=hasplms,,llm.Service

[akshhl.addservices]
DisplayName     = %svcdesc%
ServiceBinary   = %12%\akshhl.sys
ServiceType     = 1                           ;SERVICE_KERNEL_DRIVER
StartType       = 3                           ;SERVICE_DEMAND_START
ErrorControl    = 1                           ;SERVICE_ERROR_NORMAL
LoadOrderGroup  = ExtendedBase

[aksfridge.Addreg]
HKR,"exclusion","iaStorA.sys",0x0,"11.5.0.1207"


;;
;; AksFridge
;;

[aksFridge.Service]
DisplayName     = %AksFridgeServiceDisp%
Description     = %AksFridgeServiceDesc%
ServiceBinary   = %12%\aksfridge.sys          ;%windir%\system32\drivers\aksfridge.sys
ServiceType     = 1                           ;SERVICE_KERNEL_DRIVER
StartType       = 2                           ;SERVICE_AUTO_START
ErrorControl    = 1                           ;SERVICE_ERROR_NORMAL
AddReg          = aksfridge.Addreg 


[llm.Service]
DisplayName     = %llmdisp%
Description     = %llmDesc%
ServiceBinary   = %11%\hasplms.exe -run
ServiceType     = 16                        ;SERVICE_WIN32_OWN_PROCESS
StartType       = 2                         ;SERVICE_AUTO_START
ErrorControl    = 1                         ;SERVICE_ERROR_NORMAL
Dependencies    = TCPIP

;;
;; Source Files
;;

[sourcedisksnames]
1=%INSTDISK%,,,""

[SourceDisksFiles]
akshhl.sys=1
akshhl32.dll=1
hasplms.exe=1
hasplmv.exe=1
aksfridge.sys=1

[DestinationDirs]
akshhl.NT.Copy = 10,system32\drivers
aksllm.NT.Copy = 10,system32
akshhl.Copy = 10,system32\drivers
GemaltoCoInstCopyFiles = 11

[Strings]
Fast                        = "Gemalto"
FastMfg                     = "Gemalto"
svcdesc                     = "Sentinel HL Key"
llmsvcdesc                  = "Sentinel LMS"
AKSCLASS\HaspHL.DeviceDesc  = "Sentinel HL Key"
ClassName                   = "Sentinel Software Protection Devices"
INSTDISK                    = "Sentinel Install Disk"

Aks                         = "Sentinel"
AksFridgeServiceDesc        = "Sentinel Ancillary Function Driver"
AksFridgeServiceName        = "aksfridge"
AksFridgeServiceDisp        = "Sentinel Fridge"
llmdisp                     = "Sentinel LDK License Manager"
llmDesc                     = "Manages licenses secured by Sentinel LDK"
