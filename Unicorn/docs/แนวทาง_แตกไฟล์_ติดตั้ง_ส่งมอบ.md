# แนวทาง: แตกไฟล์ · ติดตั้ง · ส่งมอบ ACESO

**เอกสารแนวทาง** สำหรับผู้ดูแลระบบและผู้รับมอบ  
**อัปเดต:** ตามเส้นทางแชร์และเครื่องมือที่กำหนด

---

## สารบัญ

1. [แตกไฟล์](#1-แตกไฟล์)
2. [ติดตั้ง](#2-ติดตั้ง)
3. [ส่งมอบ](#3-ส่งมอบ)

---

## 1. แตกไฟล์

### 1.1 แหล่งไฟล์ (แชร์)

| รายการ | เส้นทาง |
|--------|---------|
| แชร์ต้นทาง | `\\Ihc-qutjv3999\d` |
| ไฟล์ Setup บนแชร์ | `\\Ihc-qutjv3999\d\AcesoSetup.exe` (~2 GB) |

### 1.2 Copy จากแชร์มาที่ D:\

**วิธีที่ 1: PowerShell (แนะนำ)**

```powershell
# ปิดโปรแกรมที่เปิด D:\AcesoSetup.exe อยู่ก่อน (ถ้ามี)
Copy-Item -Path "\\Ihc-qutjv3999\d\AcesoSetup.exe" -Destination "D:\AcesoSetup.exe" -Force
```

**วิธีที่ 2: สคริปต์ในโปรเจกต์**

```powershell
powershell -ExecutionPolicy Bypass -File "C:\Users\usEr\Project\ACESO\scripts\extract_aceso_from_share.ps1"
```

สคริปต์จะ copy จากแชร์ไป `D:\AcesoSetup.exe` (ถ้ายังไม่มี) แล้วแตกด้วย 7-Zip ไป `D:\AcesoExtracted` ถ้ามี 7-Zip ติดตั้ง

### 1.3 แตกเนื้อหา AcesoSetup.exe (เจอเครื่องมือ)

**วิธี A: รันเป็น Installer (ง่ายที่สุด)**

1. ดับเบิลคลิก `D:\AcesoSetup.exe`
2. ทำตามขั้นตอนบนหน้าจอ (Next → เลือกตำแหน่งติดตั้ง → Install)
3. เมื่อติดตั้งเสร็จ จะได้โฟลเดอร์โปรแกรม (เช่น `C:\Program Files\ACESO` หรือตามที่เลือก) พร้อม ACESO.exe, ID, ID_x64 ฯลฯ

**วิธี B: แตกด้วย 7-Zip (ไม่รัน installer)**

1. ติดตั้ง [7-Zip](https://www.7-zip.org/) ถ้ายังไม่มี (หรือ `winget install 7zip.7zip`)
2. คลิกขวาที่ `D:\AcesoSetup.exe` → **7-Zip** → **Open archive**
3. เลือกไฟล์/โฟลเดอร์ทั้งหมด → **Extract** → ระบุโฟลเดอร์ปลายทาง (เช่น `D:\AcesoExtracted`)
4. ในโฟลเดอร์ที่แตกจะเห็นไฟล์ภายใน (รวม AcesoFiles.tar.gz ถ้าเป็น NSIS ที่บรรจุ tar.gz)
5. ถ้ามีไฟล์ `.tar.gz` ให้แตกต่อด้วย 7-Zip (เปิด AcesoFiles.tar.gz แล้ว Extract อีกครั้ง) จะได้โครงสร้างโฟลเดอร์ ACESO

**วิธี C: ใช้สคริปต์ (ถ้ามี 7-Zip)**

```powershell
powershell -ExecutionPolicy Bypass -File "C:\Users\usEr\Project\ACESO\scripts\extract_aceso_from_share.ps1"
```

ผลลัพธ์แตกไปที่ `D:\AcesoExtracted`

### 1.4 โครงสร้างหลังแตก/ติดตั้ง (อ้างอิง)

```
ACESO/
├── ACESO.exe              ← โปรแกรมหลัก
├── haspclnt.dll            ← HASP License
├── Launch_ACESO.bat        ← Launcher
├── ID/                     ← HASP Driver (32-bit)
├── ID_x64/                 ← เครื่องมือ 64-bit
├── TMP/                    ← Dependencies (VC++ Redist, ฯลฯ)
├── WD/                     ← Working Directory
├── PF/                     ← Platform Files
└── RV/                     ← Report Viewer
```

---

## 2. ติดตั้ง

### 2.1 ความต้องการระบบ

- **OS:** Windows 10/11 (64-bit)
- **RAM:** 8 GB ขึ้นไป (แนะนำ 16 GB)
- **พื้นที่:** ว่างอย่างน้อย 2 GB
- **HASP USB Dongle** (จำเป็น)
- **สิทธิ์ Administrator** สำหรับการติดตั้ง

### 2.2 ขั้นตอนติดตั้ง (หลังแตกหรือรัน installer แล้ว)

**Step 1: ติดตั้ง HASP Driver**

1. เสียบ **HASP Dongle** เข้า USB
2. ไปที่โฟลเดอร์ที่แตก/ติดตั้ง → `ID_x64\` (หรือ `ID\` สำหรับ 32-bit)
3. รัน **HASPUserSetup.exe** (หรือ DPInst.exe ตามที่มี) → Next → Install
4. Restart เครื่อง (แนะนำ)

**Step 2: ติดตั้ง Dependencies (ถ้าต้องการ)**

- **Visual C++ Redistributable x64:** รัน `TMP\Redist\vc_redist.x64.exe` ถ้าโปรแกรมแจ้ง Missing DLL
- **Android USB Driver:** ใช้เมื่อจะเชื่อมมือถือ Android (ติดตั้งจากโฟลเดอร์ TMP ตามคู่มือ)

**Step 3: ตั้งค่า ACESO.exe (Windows 11)**

1. คลิกขวา **ACESO.exe** → Properties → Compatibility
2. ติ๊ก **Run this program in compatibility mode for:** เลือก **Windows 10**
3. ติ๊ก **Run this program as an administrator**
4. Apply → OK

**Step 4: วิธีเปิดใช้งาน**

1. เสียบ HASP Dongle
2. คลิกขวา **Launch_ACESO.bat** (หรือ shortcut ที่มี) → **Run as administrator**
3. หรือดับเบิลคลิก **ACESO.exe** (หลังตั้ง Compatibility แล้ว)

### 2.3 การแก้ปัญหาเบื้องต้น

| ปัญหา | แก้ไข |
|--------|--------|
| โปรแกรมไม่เปิด | ตรวจสอบ HASP Dongle, รัน as Administrator, ตั้ง Compatibility Mode |
| HASP not found | Device Manager → ดู HASP/Sentinel, รัน HASPUserSetup.exe ใน ID_x64\ |
| Missing DLL | รัน TMP\Redist\vc_redist.x64.exe |
| แชร์ไม่เชื่อมต่อ | `net use Z: \\Ihc-qutjv3999\d` (ถ้าต้องการ map drive) |

---

## 3. ส่งมอบ

### 3.1 Checklist ก่อนส่งมอบ

- [ ] แตกไฟล์/ติดตั้ง ACESO ครบแล้ว
- [ ] ติดตั้ง HASP Driver และทดสอบเปิด ACESO ได้
- [ ] มีเอกสารคู่มือ (README_TH.txt, คู่มือใน ACESO Custom\ ถ้ามี)
- [ ] บันทึกเส้นทางแชร์และเครื่องมือให้ผู้รับทราบ (ใช้เอกสาร `เส้นทางเอกสาร_แชร์และเครื่องมือ.md`)

### 3.2 แนวทางส่งมอบให้หน่วยงาน/ผู้ใช้

**แบบที่ 1: ส่งมอบโฟลเดอร์ ACESO (หลังแตกแล้ว)**

1. Zip โฟลเดอร์ ACESO ทั้งหมด (หรือใช้ 7-Zip)
2. ส่งไฟล์ ZIP ให้ผู้รับ (USB, แชร์เครือข่าย, ฯลฯ)
3. ส่งเอกสารแนวทางนี้ + **เส้นทางเอกสาร_แชร์และเครื่องมือ.md** + **README_TH.txt**
4. แจ้งผู้รับ: แตก ZIP → ติดตั้ง HASP Driver → เสียบ Dongle → รัน Launch_ACESO.bat (Run as administrator)

**แบบที่ 2: ให้ผู้รับแตก/ติดตั้งเองจากแชร์**

1. แจ้งเส้นทางแชร์: `\\Ihc-qutjv3999\d` และไฟล์ `AcesoSetup.exe`
2. ส่งเอกสารแนวทางนี้ (แตกไฟล์ · ติดตั้ง · ส่งมอบ)
3. ผู้รับ copy AcesoSetup.exe ไปยังเครื่อง (เช่น D:\) แล้วรัน installer หรือแตกด้วย 7-Zip ตาม Section 1

**แบบที่ 3: ส่งมอบ ACESO_LOCAL (โหมดออฟไลน์)**

1. ใช้โฟลเดอร์ ACESO_LOCAL ที่มี Launch_ACESO_LOCAL.bat (ไม่ต้องใช้ Python/อินเทอร์เน็ต)
2. Copy ACESO.exe, haspclnt.dll, ID, ID_x64, PF, RV, TMP, WD จาก ACESO ไป ACESO_LOCAL ตาม SETUP_INSTRUCTIONS.txt
3. Zip ACESO_LOCAL ส่งให้ผู้รับ + คู่มือ README_TH.md ใน ACESO_LOCAL

### 3.3 เอกสารที่ควรส่งพร้อมมอบ

| เอกสาร | ใช้สำหรับ |
|--------|-----------|
| **แนวทาง_แตกไฟล์_ติดตั้ง_ส่งมอบ.md** (ไฟล์นี้) | ขั้นตอนแตกไฟล์, ติดตั้ง, ส่งมอบ |
| **เส้นทางเอกสาร_แชร์และเครื่องมือ.md** | เส้นทางแชร์ \\Ihc-qutjv3999\d และ D:\AcesoSetup.exe |
| **README_TH.txt** (ในโฟลเดอร์ ACESO) | คู่มือการใช้งานและแก้ปัญหา |
| **SETUP_INSTRUCTIONS.txt** (ACESO_LOCAL) | กรณีส่งมอบแบบ Local/ออฟไลน์ |

---

*เอกสารแนวทางนี้เขียนเพื่อใช้แตกไฟล์ ติดตั้ง และส่งมอบ ACESO ตามเส้นทางแชร์และเครื่องมือที่กำหนด*
